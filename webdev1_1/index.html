<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <?!= HtmlService.createHtmlOutputFromFile('countStyle.css').getContent(); ?>
  </head>
  <body>
    <div class="overLay">
      <div id="disp_count"><?= disp_count_val ?></div>
    </div>
    <div class="box">
      <div class="overLaybtn">
        <input type="button" value="カウントアップ" id="btn_count_up" />
      </div>
      <div class="overLaybtn">
        <input type="button" value="リセット" id="btn_count_reset" />
      </div>
      <div class="overLaybtn">
        <input type="button" value="保存" id="btn_count_save" />
      </div>
    </div>
  </body>
  <script>
    // ページが読み込まれたら実行
    window.onload = function() {
      // オブジェクトと変数の準備
      const count_disp = document.getElementById("disp_count");  
      const count_up_btn = document.getElementById("btn_count_up");
      const count_reset_btn = document.getElementById("btn_count_reset");
      const count_save_btn = document.getElementById("btn_count_save");
 
      // カウントアップボタンクリック処理
      count_up_btn.onclick = function (){
        count_disp.innerHTML = Number(count_disp.textContent) + 1;
      };
      // カウントリセットボタンクリック処理
      count_reset_btn.onclick = function (){
        count_disp.innerHTML = 0;
      }
      // カウント保存ボタンクリック処理
      count_save_btn.onclick = function (){
        // 取得した値を setSheetData関数の引数として設定して呼び出します。
        google.script.run.setSheetData(Number(count_disp.textContent));
      }
    };
  </script>
</html>
